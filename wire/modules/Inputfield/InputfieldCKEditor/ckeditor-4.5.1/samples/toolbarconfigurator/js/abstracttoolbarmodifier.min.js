"function"!=typeof Object.create&&function(){var a=function(){};Object.create=function(b){if(1<arguments.length){throw Error("Second argument not supported")}if(null===b){throw Error("Cannot set a null [[Prototype]]")}if("object"!=typeof b){throw TypeError("Argument must be an object")}a.prototype=b;return new a}}();CKEDITOR.plugins.add("toolbarconfiguratorarea",{afterInit:function(a){a.addMode("wysiwyg",function(b){var d=CKEDITOR.dom.element.createFromHtml('<div class="cke_wysiwyg_div cke_reset" hidefocus="true"></div>');a.ui.space("contents").append(d);d=a.editable(d);d.detach=CKEDITOR.tools.override(d.detach,function(c){return function(){c.apply(this,arguments);this.remove()}});a.setData(a.getData(1),b);a.fire("contentDom")});a.dataProcessor.toHtml=function(b){return b};a.dataProcessor.toDataFormat=function(b){return b}}});Object.keys||(Object.keys=function(){var d=Object.prototype.hasOwnProperty,f=!{toString:null}.propertyIsEnumerable("toString"),h="toString toLocaleString valueOf hasOwnProperty isPrototypeOf propertyIsEnumerable constructor".split(" "),g=h.length;return function(c){if("object"!==typeof c&&("function"!==typeof c||null===c)){throw new TypeError("Object.keys called on non-object")}var a=[],b;for(b in c){d.call(c,b)&&a.push(b)}if(f){for(b=0;b<g;b++){d.call(c,h[b])&&a.push(h[b])}}return a}}());(function(){function a(b,d){this.cfg=d||{};this.hidden=false;this.editorId=b;this.fullToolbarEditor=new ToolbarConfigurator.FullToolbarEditor;this.actualConfig=this.originalConfig=this.mainContainer=null;this.isEditableVisible=this.waitForReady=false;this.toolbarContainer=null;this.toolbarButtons=[]}ToolbarConfigurator.AbstractToolbarModifier=a;a.prototype.setConfig=function(b){this._onInit(void 0,b,true)};a.prototype.init=function(b){var d=this;this.mainContainer=new CKEDITOR.dom.element("div");if(this.fullToolbarEditor.editorInstance!==null){throw"Only one instance of ToolbarModifier is allowed"}this.editorInstance||this._createEditor(false);this.editorInstance.once("loaded",function(){d.fullToolbarEditor.init(function(){d._onInit(b);if(typeof d.onRefresh=="function"){d.onRefresh()}},d.editorInstance.config)});return this.mainContainer};a.prototype._onInit=function(j,p){this.originalConfig=this.editorInstance.config;this.actualConfig=p?JSON.parse(p):JSON.parse(JSON.stringify(this.originalConfig));if(!this.actualConfig.toolbarGroups&&!this.actualConfig.toolbar){for(var e=this.actualConfig,o=this.editorInstance.toolbar,m=[],n=o.length,k=0;k<n;k++){var l=o[k];typeof l=="string"?m.push(l):m.push({name:l.name,groups:l.groups?l.groups.slice():[]})}e.toolbarGroups=m}typeof j==="function"&&j(this.mainContainer)};a.prototype._createModifier=function(){this.mainContainer.addClass("unselectable");this.modifyContainer&&this.modifyContainer.remove();this.modifyContainer=new CKEDITOR.dom.element("div");this.modifyContainer.addClass("toolbarModifier");this.mainContainer.append(this.modifyContainer);return this.mainContainer};a.prototype.getEditableArea=function(){return this.editorInstance.container.findOne("#"+this.editorInstance.id+"_contents")};a.prototype._hideEditable=function(){var b=this.getEditableArea();this.isEditableVisible=false;this.lastEditableAreaHeight=b.getStyle("height");b.setStyle("height","0")};a.prototype._showEditable=function(){this.isEditableVisible=true;this.getEditableArea().setStyle("height",this.lastEditableAreaHeight||"auto")};a.prototype._toggleEditable=function(){this.isEditableVisible?this._hideEditable():this._showEditable()};a.prototype._refreshEditor=function(){function e(){f.editorInstance.destroy();f._createEditor(true,f.getActualConfig());f.waitForReady=false}var f=this,d=this.editorInstance.status;if(!this.waitForReady){if(d=="unloaded"||d=="loaded"){this.waitForReady=true;this.editorInstance.once("instanceReady",function(){e()},this)}else{e()}}};a.prototype._createEditor=function(b,h){function f(){}var g=this;this.editorInstance=CKEDITOR.replace(this.editorId);this.editorInstance.on("configLoaded",function(){var c=g.editorInstance.config;h&&CKEDITOR.tools.extend(c,h,true);a.extendPluginsConfig(c)});this.editorInstance.on("uiSpace",function(c){c.data.space!="top"&&c.stop()},null,null,-999);this.editorInstance.once("loaded",function(){var e=g.editorInstance.ui.instances,d;for(d in e){if(e[d]){e[d].click=f;e[d].onClick=f}}g.isEditableVisible||g._hideEditable();g.currentActive&&g.currentActive.name&&g._highlightGroup(g.currentActive.name);g.hidden?g.hideUI():g.showUI();if(b&&typeof g.onRefresh==="function"){g.onRefresh()}})};a.prototype.getActualConfig=function(){return JSON.parse(JSON.stringify(this.actualConfig))};a.prototype._createToolbar=function(){if(this.toolbarButtons.length){this.toolbarContainer=new CKEDITOR.dom.element("div");this.toolbarContainer.addClass("toolbar");for(var b=this.toolbarButtons.length,d=0;d<b;d=d+1){this._createToolbarBtn(this.toolbarButtons[d])}}};a.prototype._createToolbarBtn=function(b){var d=ToolbarConfigurator.FullToolbarEditor.createButton(typeof b.text==="string"?b.text:b.text.inactive,b.cssClass);this.toolbarContainer.append(d);d.data("group",b.group);d.addClass(b.position);d.on("click",function(){b.clickCallback.call(this,d,b)},this);return d};a.prototype._fixGroups=function(f){for(var f=f.toolbarGroups||[],h=f.length,e=0;e<h;e=e+1){var g=f[e];if(g=="/"){g=f[e]={};g.type="separator";g.name="separator"+CKEDITOR.tools.getNextNumber()}else{g.groups=g.groups||[];if(CKEDITOR.tools.indexOf(g.groups,g.name)==-1){this.editorInstance.ui.addToolbarGroup(g.name,g.groups[g.groups.length-1],g.name);g.groups.push(g.name)}this._fixSubgroups(g)}}};a.prototype._fixSubgroups=function(f){for(var f=f.groups,h=f.length,e=0;e<h;e=e+1){var g=f[e];f[e]={name:g,totalBtns:ToolbarConfigurator.ToolbarModifier.getTotalSubGroupButtonsNumber(g,this.fullToolbarEditor)}}};a.stringifyJSONintoOneLine=function(d,c){var c=c||{},f=JSON.stringify(d,null,""),f=f.replace(/\n/g,"");if(c.addSpaces){f=f.replace(/(\{|:|,|\[|\])/g,function(b){return b+" "});f=f.replace(/(\])/g,function(b){return" "+b})}c.noQuotesOnKey&&(f=f.replace(/"(\w*)":/g,function(g,e){return e+":"}));c.singleQuotes&&(f=f.replace(/\"/g,"'"));return f};a.prototype.hideUI=function(){this.hidden=true;this.mainContainer.hide();this.editorInstance.container&&this.editorInstance.container.hide()};a.prototype.showUI=function(){this.hidden=false;this.mainContainer.show();this.editorInstance.container&&this.editorInstance.container.show()};a.extendPluginsConfig=function(d){var c=d.extraPlugins,f=d.removePlugins;d.extraPlugins=(c?c+",":"")+"toolbarconfiguratorarea";d.removePlugins=(f?f+",":"")+"autogrow,dialogadvtab,elementspath,enterkey,floatingspace,htmlwriter,magicline,resize,sharedspace,tab,wysiwygarea"}})();