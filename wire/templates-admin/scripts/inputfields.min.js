var InputfieldDebugMode=false;function consoleLog(a){if(InputfieldDebugMode){console.log(a)}}var InputfieldDependenciesProcessing=false;function InputfieldDependencies(g){if(InputfieldDependenciesProcessing){return}if(typeof g=="undefined"){var g=$(".InputfieldForm:not(.InputfieldFormNoDependencies)")}function h(l){l=jQuery.trim(l);var m=l.substring(0,1);var k=l.substring(l.length-1,l.length);if((m=='"'||m=="'")&&m==k){l=l.substring(1,l.length-1)}return l}function i(k){return f(h(k))}function b(m){var l="";var k=m.indexOf(".");if(k>0){l=m.substring(k+1);m=m.substring(0,k)}return{field:m,subfield:l}}function f(n,l){n=jQuery.trim(n);if(n.length>0&&!jQuery.isNumeric(n)){return n}if(n.length==0){var k=typeof l;if(k!="undefined"){if(k=="integer"){return 0}if(k=="float"){return 0}return n}else{return n}}var o=n.indexOf(".");var m=n.lastIndexOf(".");if(o==-1&&/^-?\d+$/.test(n)){return parseInt(n)}if(m>-1&&o!=m){return n}if(/^-?[\d.]+$/.test(n)){return parseFloat(n)}return n}function c(n,l,m,o){var k=0;switch(l){case"=":if(m==o){k++}break;case"!=":if(m!=o){k++}break;case">":if(m>o){k++}break;case"<":if(m<o){k++}break;case">=":if(m>=o){k++}break;case"<=":if(m<=o){k++}break;case"*=":case"%=":if(m.indexOf(o)>-1){k++}break}consoleLog("Field "+n+" - Current value: "+m);consoleLog("Field "+n+" - Matched? "+(k>0?"YES":"NO"));return k}function d(o,q,m){var t=null;var w;consoleLog("getCheckboxFieldAndValue(see-next-line, "+q+", "+m+")");consoleLog(o);if(m=="count"||m=="count-checkbox"){consoleLog("Using count checkbox condition");t=$("#wrap_Inputfield_"+q+" :input");if(t.length){w=$("#wrap_Inputfield_"+q+" :checked").length;o.subfield="count-checkbox";return{field:t,value:w,condition:o}}return null}consoleLog("Using checkbox value or label comparison option");w=[];for(var p=0;p<o.values.length;p++){var r=new String(o.values[p]);r=h(r.replace(/\s/g,"_"));consoleLog("conditionValue: "+r);var x="#Inputfield_"+q+"_"+r;t=$(x);if(t.length){consoleLog("Found checkbox via value "+x);var n="";if(t.is(":checked")){n=t.val();consoleLog("Checkbox IS checked: "+x)}else{consoleLog("Checkbox is NOT checked: "+x)}if(n.length){w.push(n)}continue}if(r.length==0||r.match(/^[0-9]+$/)){consoleLog("Unable to locate checkbox "+x+", skipping");continue}consoleLog("Attempting to find checkbox by label: "+r);t=$("#wrap_Inputfield_"+q);var k=t.find("input:checked");for(var v=0;v<k.length;v++){var l=k.eq(v);var s=l.closest("label");if(s.length){var u=jQuery.trim(s.text());if(u==r){consoleLog("Matching checked label found: "+r);w.push(u)}else{consoleLog("Matching checked label not found: "+r)}}}}if(t){return{field:t,value:w,condition:o}}return null}function e(p,y){InputfieldDependenciesProcessing=true;var C=y.attr("id").replace(/wrap_Inputfield_/,"");if(InputfieldDebugMode){consoleLog("-------------------------------------------------------------------");consoleLog('Field "'+C+'" detected a change to a dependency field! Beginning dependency checks...')}var o=0;var J=true;var w=0;var u=0;for(var I=0;I<p.length;I++){var E=p[I];if(InputfieldDebugMode){consoleLog("----");consoleLog("Start Dependency "+I);consoleLog("Condition type: "+E.type);consoleLog("Field: "+E.field);if(E.subfield.length>0){consoleLog("Subfield: "+E.subfield)}consoleLog("Operator: "+E.operator);consoleLog("Required value: "+E.value)}var s=0;for(var q=0;q<E.fields.length;q++){var F=b(E.fields[q]);var r=F.field;var k=F.subfield;var A=null;var B=$("#Inputfield_"+r);var l=false;if(B.length==0){B=$("#"+r)}if(B.length==0){consoleLog("Detected possible checkbox or radio: "+E.field+E.operator+E.value);var H=d(E,r,k);if(H){B=H.field;A=H.value;E=H.condition;l=true}}if(B.length==0){consoleLog("Unable to locate field: "+r);continue}if(A===null){if(B.attr("type")=="checkbox"){A=B.is(":checked")?B.val():null}else{A=B.val()}}var m=[];if(A==null){A=""}if(E.subfield=="count"){A=A.length}if(typeof A=="object"){m=jQuery.makeArray(A)}else{if(typeof A=="array"){m=A}else{m[0]=A}}var G=1;if(E.operator=="!="){G=(m.length*E.values.length)}if((B.attr("type")=="checkbox"||B.attr("type")=="radio")&&!B.is(":checked")){m[1]="0"}for(var z=0;z<m.length;z++){for(var D=0;D<E.values.length;D++){var x=f(m[z],E.values[D]);s+=c(r,E.operator,x,E.values[D])}}if(s>=G){break}}consoleLog("----");if(E.type=="show"){if(s>=G){}else{J=false}}else{if(E.type=="required"){if(s>0){w++}else{u++}}}}var t=w>0&&u==0;if(J){consoleLog('Determined that field "'+C+'" should be visible.');if(y.is(".InputfieldStateHidden")){y.removeClass("InputfieldStateHidden").fadeIn();o++;consoleLog("Field is now visible.")}else{consoleLog("Field is already visible.")}}else{consoleLog('Determined that field "'+C+'" should be hidden.');if(!y.is(".InputfieldStateHidden")){y.addClass("InputfieldStateHidden").hide();consoleLog("Field is now hidden.");o++}else{consoleLog("Field is already hidden.")}if(t){consoleLog("Field is required but cancelling that since it is not visible.");t=false}}if(t&&w>0){consoleLog('Determined that field "'+C+'" should be required.');y.addClass("InputfieldStateRequired").find(":input:visible[type!=hidden]").addClass("required")}else{if(!t&&u>0){consoleLog('Determined that field "'+C+'" should not be required.');y.removeClass("InputfieldStateRequired").find(":input.required").removeClass("required")}}if(o>0){consoleLog(o+" visibility changes were made.");InputfieldColumnWidths();$(window).resize()}InputfieldDependenciesProcessing=false}function a(z,m,s){var A=s.attr("data-"+z+"-if");if(!A||A.length<1){return m}A=$("<div />").html(A).text();consoleLog("-------------------------------------------------------------------");consoleLog('Analyzing "'+z+'" selector: '+A);var v=A.match(/(^|,)([^,]+)/g);for(var w=0;w<v.length;w++){var y=v[w];var o=y.match(/^[,\s]*([_.|a-zA-Z0-9]+)(=|!=|<=|>=|<|>|%=)([^,]+),?$/);if(!o){continue}var k=o[1];var q=o[2];var x=o[3];var r="";var t=[];var l=[];if(k.indexOf("|")>-1){consoleLog("OR field dependency: "+k);t=k.split("|")}else{t=[k]}var D=b(k);k=D.field;r=D.subfield;if(InputfieldDebugMode){consoleLog("Field: "+k);if(r.length){consoleLog("Subfield: "+r)}consoleLog("Operator: "+q);consoleLog("value: "+x)}if(x.indexOf("|")>-1){consoleLog("OR value dependency: "+x);l=x.split("|");for(var B=0;B<l.length;B++){l[B]=i(l[B])}}else{l=[i([x])]}var C={type:z,field:k,fields:t,subfield:r,operator:q,value:x,values:l};m[m.length]=C;for(var p=0;p<t.length;p++){var D=b(t[p]);var E=D.field;var u=$("#Inputfield_"+E);if(u.length==0){consoleLog("Unable to find inputfield by: #Inputfield_"+E);u=$("#"+E);if(u.length==0){consoleLog("Unable to find inputfield by: #"+E)}}if(u.length==0){u=$("#wrap_Inputfield_"+E).find(":input");if(u.length==0){consoleLog("Unable to find inputfield by: #wrap_Inputfield_"+E+" :input")}}if(u.length){consoleLog("Attaching change event for: "+u.attr("name"));u.change(function(){e(m,s)})}else{consoleLog("Failed to find inputfield, no change event attached")}}}return m}function j(l){var k=[];k=a("show",k,l);k=a("required",k,l);e(k,l)}InputfieldDependenciesProcessing=true;$(g).each(function(){$(this).find(".InputfieldStateShowIf, .InputfieldStateRequiredIf").each(function(){j($(this))})});InputfieldDependenciesProcessing=false}function InputfieldColumnWidths(){var f=null;var c=null;function a(i){if(i.is(".InputfieldStateHidden")){return 0}var j=i.attr("style");if(typeof j=="undefined"||!j){return i.width()}var k=parseInt(j.match(/width:\s*(\d+)/i)[1]);if(!i.attr("data-original-width")){i.attr("data-original-width",k)}return k}function e(j){var i=parseInt(j.attr("data-original-width"));if(i==0){i=a(j)}return i}function d(j,k,i){j.width(k+"%");if(i){j.css("opacity",0.5);j.animate({opacity:1},150,function(){})}consoleLog("setWidth("+j.attr("id")+": "+k+"%")}function h(i){return i.height()}function b(i,l){var j=h(i);consoleLog("setHeight: "+i.find("label").text()+" >> "+l+" ("+j+")");if(j==l){return}if(i.hasClass("InputfieldStateCollapsed")){return}var m=l-j;if(m<0){m=0}var n=i.children(".InputfieldContent, .ui-widget-content");if(m==0){}else{consoleLog("Adjusting "+i.attr("id")+" from "+j+" to "+l);var k=$("<div class='maxColHeightSpacer'></div>");n.append(k);n.hide();k.height(m);n.show()}}function g(m){var q=m.nextUntil(".InputfieldColumnWidthFirst",".InputfieldColumnWidth:not(.InputfieldStateHidden)");var l=m.is(".InputfieldStateHidden")?0:a(m);var t=m.is(".InputfieldStateHidden")?null:m;var r=t==null?0:l;var s=q.length;if(m.is(".InputfieldStateHidden")){s--;var n=q.eq(0)}else{var n=m}if(c){n.find(".maxColHeightSpacer").remove();q.find(".maxColHeightSpacer").remove()}var j=100-(s*f);var i=c?h(n):0;q.removeClass("InputfieldColumnWidthFirstTmp");q.each(function(){t=$(this);r=a(t);l+=r;if(c){var u=h(t);if(u>i){i=u}}});if(c){if(InputfieldDebugMode){var o=n.find("label").text();consoleLog("maxColHeight: "+o+" = "+i)}if(i>0){b(n,i);q.each(function(){b($(this),i)})}}if(l<j){consoleLog("Expand width of row because rowWidth < maxRowWidth ("+l+" < "+j+")");var p=(j-l);consoleLog("leftoverWidth: "+p);r=r+p;if(t==null&&!m.is(".InputfieldStateHidden")){t=m}if(t){var k=e(t);if(k>0&&r<k){r=k}d(t,r,true)}}else{if(l>j){consoleLog("Reduce width of row because rowWidth > maxRowWidth ("+l+" > "+j+")");if(!m.is(".InputfieldStateHidden")){q=m.add(q)}l=0;q.each(function(){t=$(this);r=e(t);if(r>0){d(t,r,false)}l+=r});var p=j-l;r+=p;var k=e(t);if(k>0&&r<k){r=k}d(t,r,false)}}if(m.is(".InputfieldStateHidden")){n.addClass("InputfieldColumnWidthFirstTmp")}}$("form.InputfieldForm").each(function(){var i=$(this);if(i.hasClass("InputfieldFormNoWidths")){return}f=i.attr("data-colspacing");if(typeof f=="undefined"){f=1}c=i.hasClass("InputfieldFormNoHeights")?false:true;$(".Inputfield:not(.InputfieldColumnWidth)",i).addClass("InputfieldColumnWidthFirst");$(".InputfieldColumnWidthFirst.InputfieldColumnWidth:visible",i).each(function(){g($(this))})});$(document).on("change",".InputfieldColumnWidth :input",function(){var i=$(this).closest(".InputfieldColumnWidth");var j=i.is(".InputfieldColumnWidthFirst")?i:i.prev(".InputfieldColumnWidthFirst");g(j)})}function InputfieldFormBeforeUnloadEvent(b){var a=$(".InputfieldFormConfirm:not(.InputfieldFormSubmitted) .InputfieldStateChanged");if(a.length==0){return}var c=$(".InputfieldFormConfirm:eq(0)").attr("data-confirm")+"\n";a.each(function(){var d=$(this).find(".InputfieldHeader:eq(0)");if(d.length){name=d.text()}else{name=$(this).attr("data-label");if(!name||!name.length){name=$(this).find(":input").attr("name")}}if(name.length){c+="\n• "+$.trim(name)}});(b||window.event).returnValue=c;return c}function InputfieldStates(){function b(i){function g(j,k){j.fadeTo("fast",0.5,function(){j.fadeTo("fast",1,function(){if(k.hasClass("InputfieldAjaxLoading")){g(j,k)}})})}var h=i.children(".InputfieldContent").children(".renderInputfieldAjax");var c=false;if(!h.length){h=i.children(".renderInputfieldAjax");c=true}var f=h.children("input").attr("value");if(typeof f=="undefined"||f.length<1){return false}var e=null;if(c){var d=$("#_"+i.attr("id"));g(d,i)}else{var d=i.children(".InputfieldHeader");e=$("<i class='fa fa-spin fa-spinner'></i>");e.css("margin-left","0.5em");d.append(e)}i.removeClass("collapsed10 collapsed11 ").addClass("InputfieldAjaxLoading");$.get(f,function(j){i.removeClass("InputfieldAjaxLoading InputfieldStateCollapsed");h.replaceWith($(j)).hide();h.slideDown();i.trigger("reloaded");i.find(".Inputfield:not(.collapsed9) > .InputfieldHeader").addClass("InputfieldStateToggle");i.find(".Inputfield").trigger("reloaded");if(i.closest(".InputfieldFormNoDependencies").length==0){InputfieldDependencies(i.parent())}setTimeout(function(){if(e){e.fadeOut("fast",function(){e.remove()})}d.click()},500)},"html");return true}$(".Inputfield:not(.collapsed9) > .InputfieldHeader, .Inputfield:not(.collapsed9) > .ui-widget-header").addClass("InputfieldStateToggle");$(document).on("wiretabclick",function(f,d,c){if(d.hasClass("collapsed10")){b(d)}});$(document).on("click",".InputfieldStateToggle, .toggle-icon",function(){var j=$(this);var i=j.closest(".Inputfield");var h=j.hasClass("toggle-icon");var e=h?j:i.children(".InputfieldHeader, .ui-widget-header").find(".toggle-icon");var f=i.hasClass("InputfieldStateCollapsed");var g=i.hasClass("InputfieldStateWasCollapsed");if(i.hasClass("InputfieldAjaxLoading")){return false}if(f&&(i.hasClass("collapsed10")||i.hasClass("collapsed11"))){if(b(i)){return false}}if(f||g||h){i.addClass("InputfieldStateWasCollapsed");i.trigger(f?"openReady":"closeReady");i.toggleClass("InputfieldStateCollapsed",100,function(){i.trigger(f?"opened":"closed");var l=i.find(":input:visible");if(l.length==1&&!l.is("button")){var k=l.attr("type");if(l.is("textarea")||k=="text"||k=="email"||k=="url"||k=="number"){l.focus()}}});e.toggleClass(e.attr("data-to"));setTimeout("InputfieldColumnWidths()",500)}else{if(typeof jQuery.ui!="undefined"){var d=e.css("color");var c=i.children(".InputfieldHeader, .ui-widget-header").css("color");e.css("color",c);e.effect("pulsate",300,function(){e.css("color",d)})}i.find(":input:visible:eq(0)").focus()}return false});var a=$(".Inputfields .InputfieldStateCollapsed > .InputfieldHeader i.toggle-icon, .Inputfields .InputfieldStateCollapsed > .ui-widget-header i.toggle-icon");a.toggleClass(a.attr("data-to"));if(typeof config!=="undefined"&&config.debug){$("label.InputfieldHeader > i.toggle-icon").hover(function(){var c=$(this).parent("label");if(c.length==0){return}var e=c.attr("for").replace(/^Inputfield_/,"");if(e.length){var d=$("<small class='InputfieldNameTip ui-priority-secondary'>&nbsp;"+e+"&nbsp;</small>");d.css("float","right");c.append(d)}},function(){var c=$(this).parent("label");if(c.length==0){return}c.find(".InputfieldNameTip").remove()})}$("#content .InputfieldFormFocusFirst:not(.InputfieldFormNoFocus)").find("input[type=text]:enabled:first:not(.hasDatepicker):not(.InputfieldNoFocus)").each(function(){var c=$(this);if(c.val()){return}if(c.offset().top<$(window).height()){window.setTimeout(function(){if(c.is(":visible")){c.focus()}},250)}});$(document).on("change",".InputfieldFormConfirm :input",function(){$(this).closest(".Inputfield").addClass("InputfieldStateChanged")});$(document).on("submit",".InputfieldFormConfirm",function(){$(this).addClass("InputfieldFormSubmitted")});window.addEventListener("beforeunload",InputfieldFormBeforeUnloadEvent)}function InputfieldIntentions(){$(".InputfieldForm").each(function(){var a=$(this);var b=null;var c=null;a.submit(function(){if(!$(this).hasClass("nosubmit")){return}if(!c){return}var e=null;var d=c.closest(".Inputfields");do{e=d.find("input[type=submit]:visible, button[type=submit]:visible");if(e.length>0){break}d=d.parent().closest(".Inputfields")}while(d.length>0);if(e.length>0){var f=e.eq(0);$("html, body").animate({scrollTop:f.offset().top},"fast");f.focus()}return false}).on("focus","input, select",function(){if(b===null){b=a.find("input[type=submit], button[type=submit]").length}if(b<2){return}a.addClass("nosubmit");c=$(this)}).on("blur","input, select",function(){a.removeClass("nosubmit")})})}var InputfieldWindowResizeQueued=false;function InputfieldWindowResizeActions1(){consoleLog("InputfieldWindowResizeActions1()");$(".Inputfield").trigger("resized")}function InputfieldWindowResizeActions2(){consoleLog("InputfieldWindowResizeActions2()");InputfieldColumnWidths();InputfieldWindowResizeQueued=false}jQuery(document).ready(function(b){InputfieldStates();InputfieldDependencies(b(".InputfieldForm:not(.InputfieldFormNoDependencies)"));InputfieldIntentions();setTimeout(function(){InputfieldColumnWidths()},100);var c=function(){if(InputfieldWindowResizeQueued){return}InputfieldWindowResizeQueued=true;setTimeout("InputfieldWindowResizeActions1()",1000);setTimeout("InputfieldWindowResizeActions2()",2000)};var a=function(){if(InputfieldWindowResizeQueued){return}InputfieldWindowResizeQueued=true;setTimeout("InputfieldWindowResizeActions1()",250);setTimeout("InputfieldWindowResizeActions2()",500);return true};b(window).resize(c);b("ul.WireTabs > li > a").click(a);b(document).on("reload",".Inputfield",function(f){var h=b(this);var d=h.closest("form");var g=h.attr("id").replace("wrap_Inputfield_","");var e=d.attr("action")+"&field="+g;consoleLog("Inputfield reload: "+g);b.get(e,function(j){var i=b(j).find("#"+h.attr("id")).children(".InputfieldContent");h.children(".InputfieldContent").html(i.html());if(typeof jQuery.ui!="undefined"){h.effect("highlight",1000)}h.trigger("reloaded")});f.stopPropagation()})});